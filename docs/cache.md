# Кэширование

## `options.cache`

Эти три параметра позволяют закэшировать блок и при последующем запуске брать результат из кэша.

Для начала нужно задать кэш, в который мы будем писать и из которого будем читать данные.
Кэш это объект с двумя методами:

```js
const cache = {
    get: function( { key, context } ) { ... },
    set: function( { key, value, maxage, context } ) { ... },
};
```

  * Метод `get` должен вернуть данные, соответствующие переданному ключу. Синхронно или в виде промиса.
  * Метод `set` соответственно, должен сохранить значение `value` по ключу `key` на период `maxage`.
    Результат работы `set` игнорируется.

Есть встроенный очень простой кэш `de.Cache`:

```js
const cache = new de.Cache();
```

Он хранит все просто в памяти, `maxage` задается в миллисекундах. Нет ограничений на количество записей.
Так что для каких-то серьезных ситуаций лучше его не использовать, а использовать [descript2-memcached](https://github.com/doochik/descript2-memcached).

Задаем блоку кэш:

```js
const cache = new de.Cache();

const block = de.block( {
    options: {
        cache: cache,
    }
} );
```


## `options.key`, `options.maxage`

Параметры `key` и `maxage` задают ключ и срок хранения:

```js
options: {
    //  Кэшируем по имени метода и параметру id.
    key: ( { params } ) => `my_method:id=${ params.id }`,
    //  Храним 1 час.
    maxage: 60 * 60 * 1000,
    //  Задаем в каком кэше все храним.
    cache: cache,
},
```

